<div class="card flex flex-col h-full">
  <div class="flex justify-start mb-5">
    <p-button label="Novo" icon="pi pi-plus" outlined="true" (onClick)="createProject()" />
  </div>
  <p-table #dt
    [value]="projects.length ? projects : skeleton"
    [lazy]="true"
    (onLazyLoad)="loadProjectsLazy($event)"
    [paginator]="true"
    [alwaysShowPaginator]="false"
    [pageLinks]="3"
    [rows]="10"
    [rowsPerPageOptions]="[10, 50, 100]"
    [filterDelay]="1000"
    [rowHover]="true"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} projetos"
    paginatorDropdownAppendTo="body"
    tableStyleClass="w-full h-full"
    size="small">
    <ng-template #header>
      <tr>
        <th pSortableColumn="name">
          Nome
          <p-sortIcon field="name" />
        </th>
        <th pSortableColumn="description">
          Descrição
          <p-sortIcon field="description" />
        </th>
        <th>
          Token
        </th>
        <th pSortableColumn="lastVersion">
          Última Versão
          <p-sortIcon field="lastVersion" />
        </th>
        <th pSortableColumn="responsibleName">
          Responsável
          <p-sortIcon field="responsibleName" />
        </th>
        <th style="width: 10rem;">Ações</th>
      </tr>
      <tr>
        <th>
          <p-columnFilter type="text" field="name" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th>
          <p-columnFilter type="text" field="description" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th></th>
        <th>
          <p-columnFilter type="text" field="lastVersion" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th>
          <p-columnFilter type="text" field="responsibleName" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template #body let-project>
      <tr *ngIf="projects.length">
        <td>{{ project.name }}</td>
        <td>{{ project.description }}</td>
        <td>
          <p-button icon="pi pi-copy" pTooltip="Copiar token" tooltipPosition="top" [text]="true" (onClick)="copyToken(project.token)" />
        </td>
        <td>{{ project.lastVersion }}</td>
        <td>{{ project.responsibleName }}</td>
        <td>
          <p-button icon="pi pi-box" pTooltip="Versões do aplicativo" tooltipPosition="top" class="mr-2" [rounded]="true" [outlined]="true" (onClick)="listVersions(project.id, project.lastVersion)" />
          <p-button icon="pi pi-pencil" pTooltip="Editar aplicativo" tooltipPosition="top" severity="warn" class="mr-2" [rounded]="true" [outlined]="true" (onClick)="updateProject(project)" />
          <p-button icon="pi pi-trash" pTooltip="Deletar aplicativo" tooltipPosition="top" severity="danger" [rounded]="true" [outlined]="true" (onClick)="deleteProject($event, project.id)" />
        </td>
      </tr>
      <tr *ngIf="!requestReturned && !projects.length">
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
      </tr>
      <tr *ngIf="requestReturned && !projects.length">
        <td colspan="6" style="text-align: center;">
          Nenhum aplicativo encontrado.
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

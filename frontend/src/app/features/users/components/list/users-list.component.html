<div class="card flex flex-col h-full">
  <div class="flex justify-start mb-5">
    <p-button label="Novo" icon="pi pi-plus" outlined="true" (onClick)="createUser()" />
  </div>
  <p-table #dt
    [value]="users.length ? users : skeleton"
    [lazy]="true"
    (onLazyLoad)="loadUsersLazy($event)"
    [paginator]="true"
    [alwaysShowPaginator]="false"
    [pageLinks]="3"
    [rows]="10"
    [rowsPerPageOptions]="[10, 50, 100]"
    [filterDelay]="1000"
    [rowHover]="true"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} usuários"
    paginatorDropdownAppendTo="body"
    tableStyleClass="w-full h-full"
    size="small">
    <ng-template #header>
      <tr>
        <th pSortableColumn="name">
          Nome
          <p-sortIcon field="name" />
        </th>
        <th pSortableColumn="email">
          Email
          <p-sortIcon field="email" />
        </th>
        <th>Acesso(s)</th>
        <th style="width: 10rem;">Ações</th>
      </tr>
      <tr>
        <th>
          <p-columnFilter type="text" field="name" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th>
          <p-columnFilter type="text" field="email" matchMode="contains" showMenu="false" pTooltip="Pressione enter para pesquisar" tooltipEvent="focus" tooltipPosition="top"></p-columnFilter>
        </th>
        <th>
        </th>
        <th>
        </th>
      </tr>
    </ng-template>
    <ng-template #body let-user>
      <tr *ngIf="users.length">
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td>
          <p-tag *ngFor="let access of user.accesses"
            [value]="getName(access)" severity="info" class="mx-1" />
        </td>
        <td>
          <p-button icon="bi bi-person-gear" class="mr-2" [rounded]="true" [outlined]="true" (onClick)="userAcess(user)" />
          <p-button icon="pi pi-pencil" severity="warn" class="mr-2" [rounded]="true" [outlined]="true" (onClick)="updateUser(user)" />
          <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" (onClick)="deleteUser($event, user.id)" />
        </td>
      </tr>
      <tr *ngIf="!requestReturned && !users.length">
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
      </tr>
      <tr *ngIf="requestReturned && !users.length">
        <td colspan="4" style="text-align: center;">
          Nenhum usuário encontrado.
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
